(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4870],{51706:function(e,t,a){"use strict";a.d(t,{I6:function(){return i},Nw:function(){return n}});let{actions:n,reducer:i}=(0,a(31116).oM)({name:"menu",initialState:{loading:!1,queryOptions:{},menuRequest:{},menus:{},menuData:{}},reducers:{setQueryOptions(e,t){e.queryOptions=t.payload},setLoading(e,t){e.loading=t.payload},fetchMenu(e,t){},setMenus(e,t){e.menus=t.payload},createMenu(e,t){},deleteMenu(e,t){},fetchMenuById(e,t){},setSelectedMenuData(e,t){e.menuData=t.payload}}})},77630:function(e,t,a){"use strict";a.d(t,{I6:function(){return i},Nw:function(){return n}});let{actions:n,reducer:i}=(0,a(31116).oM)({name:"power",initialState:{loading:!1,queryOptions:{},powerRequest:{},powers:{},powerData:{}},reducers:{setQueryOptions(e,t){e.queryOptions=t.payload},setLoading(e,t){e.loading=t.payload},fetchPower(e,t){},setPowers(e,t){e.powers=t.payload},createOrUpdatePower(e,t){},changeRowPower(e,t){},deletePower(e,t){},fetchPowerById(e,t){},setSelectedPowerData(e,t){e.powerData=t.payload}}})},90338:function(e,t,a){"use strict";a.d(t,{I6:function(){return i},Nw:function(){return n}});let{actions:n,reducer:i}=(0,a(31116).oM)({name:"role",initialState:{loading:!1,queryOptions:{},roleRequest:{},roles:{},roleData:{},powerTree:{name:"ALL",id:"menu:0"}},reducers:{setQueryOptions(e,t){e.queryOptions=t.payload},setLoading(e,t){e.loading=t.payload},fetchRole(e,t){},setRoles(e,t){e.roles=t.payload},fetchPowerTree(e,t){},setPowerTree(e,t){e.powerTree=t.payload},createOrUpdateRole(e,t){},changeRowRole(e,t){},deleteRole(e,t){},fetchRoleById(e,t){},setSelectedRoleData(e,t){e.roleData=t.payload}}})},94222:function(e,t,a){"use strict";a.d(t,{I6:function(){return i},Nw:function(){return n}});let{actions:n,reducer:i}=(0,a(31116).oM)({name:"user",initialState:{loading:!1,queryOptions:{},userRequest:{},users:{},userData:{},userRole:{}},reducers:{setQueryOptions(e,t){e.queryOptions=t.payload},setLoading(e,t){e.loading=t.payload},fetchUser(e,t){},setUsers(e,t){e.users=t.payload},fetchUserRole(e,t){},setUserRole(e,t){e.userRole=t.payload},createUser(e,t){},deleteUser(e,t){},fetchUserById(e,t){},setSelectedUserData(e,t){e.userData=t.payload}}})},49401:function(e,t,a){"use strict";a.d(t,{I6:function(){return i},Nw:function(){return n}});let{actions:n,reducer:i}=(0,a(31116).oM)({name:"exploit",initialState:{loading:!1,queryOptions:{},exploits:[],exploitData:{},nodes:[],total:0,pdfData:{}},reducers:{setQueryOptions(e,t){e.queryOptions=t.payload},setLoading(e,t){e.loading=t.payload},setNodes(e,t){e.nodes=t.payload},fetchExploit(e,t){},setExploits(e,t){e.exploits=t.payload},setTotal(e,t){e.total=t.payload},fetchExploitById(e,t){},setSelectedExploitData(e,t){e.exploitData=t.payload},fetchPdfByid(e,t){},setPdf(e,t){e.pdfData=t.payload}}})},97875:function(e,t,a){"use strict";a.d(t,{I6:function(){return i},Nw:function(){return n}});let{actions:n,reducer:i}=(0,a(31116).oM)({name:"reconnaissance",initialState:{loading:!1,reconnaissanceRequest:{},reconnaissances:[],reconnaissanceData:{},total:0,pdfData:{},flowControl:{},history:[],fetchDataError:!1},reducers:{setLoading(e,t){e.loading=t.payload},setReconnaissanceRequest(e,t){e.reconnaissanceRequest=t.payload},fetchReconnaissance(e,t){},setReconnaissances(e,t){e.reconnaissances=t.payload},setTotal(e,t){e.total=t.payload},createReconnaissance(e,t){},deleteReconnaissance(e,t){},fetchReconnaissanceByid(e,t){},setSelectedReconnaissanceData(e,t){e.reconnaissanceData=t.payload},setFlowControl(e,t){e.flowControl=t.payload},fetchPdfByid(e,t){},setPdf(e,t){e.pdfData=t.payload},setPdfScanResultDount(e,t){e.pdfData.scan_result.dount=t.payload},updateHistory(e,t){},setHistory(e,t){e.history=t.payload}}})},29059:function(e,t,a){"use strict";a.d(t,{$v:function(){return r},E2:function(){return o},JR:function(){return y},Ks:function(){return d},ec:function(){return c},w5:function(){return l},xK:function(){return s}});var n=a(74042);let i=e=>e.reconnaissance,o=(0,n.P1)(i,e=>e.loading),s=(0,n.P1)(i,e=>e.reconnaissanceRequest),d=(0,n.P1)(i,e=>e.reconnaissances),c=(0,n.P1)(i,e=>e.total),l=(0,n.P1)(i,e=>e.reconnaissanceData);(0,n.P1)(i,e=>e.flowControl);let r=(0,n.P1)(i,e=>e.pdfData),y=(0,n.P1)(i,e=>e.history)},78166:function(e,t,a){"use strict";a.d(t,{default:function(){return ez}});var n=a(57437),i=a(30998),o=a(11444),s=a(31116),d=a(79958),c=a(46804),l=a(49401),r=a(97875),y=a(51706),u=a(76521),f=a(77630),w=a(90338),p=a(94222),g=a(34436);let R=(0,c.UY)({exploit:l.I6,reconnaissance:r.I6,notification:u.I6,menu:y.I6,power:f.I6,role:w.I6,user:p.I6,sidebar:g.I6});var h=a(49655),N=a(2852);let z={findUnique:async e=>{let t=await fetch("/api/task/exploit/".concat(e),{headers:{"Content-Type":"application/json"}});return await t.json()}},m=function*(e){try{yield(0,h.gz)(l.Nw.setLoading(!0));let t=yield N.O.findMany(e.payload);yield(0,h.gz)(l.Nw.setTotal(t.count)),yield(0,h.gz)(l.Nw.setExploits(t.data)),yield(0,h.gz)(l.Nw.setLoading(!1))}catch(e){console.error(e)}},O=function*(e){try{yield(0,h.gz)(l.Nw.setLoading(!0));let t=(yield z.findUnique(e.payload)).data.target,a=null==t?void 0:t.map(e=>({id:e,label:e}));yield(0,h.gz)(l.Nw.setNodes(a)),yield(0,h.gz)(l.Nw.setLoading(!1))}catch(e){console.error(e)}},S=function*(e){try{yield(0,h.gz)(l.Nw.setLoading(!0));let t=yield N.O.reportExploitData(e.payload);t.success&&(yield(0,h.gz)(l.Nw.setPdf(t.data))),yield(0,h.gz)(l.Nw.setLoading(!1))}catch(e){u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Reconnaissance","Reconnaissance data fetched failed"))}},U=function*(){yield(0,h.Fm)(l.Nw.fetchExploit,m),yield(0,h.Fm)(l.Nw.fetchExploitById,O),yield(0,h.Fm)(l.Nw.fetchPdfByid,S)};var P=a(55972),T=a(29059);let j=(0,P.mP)(),v=function*(e){try{yield(0,h.gz)(r.Nw.setLoading(!0)),e.payload&&(yield(0,h.gz)(r.Nw.setReconnaissanceRequest(e.payload)));let t=yield N.O.findMany(e.payload);if(t.data)for(let e of t.data)2!=e.status&&j.emit("create_room",e.id);yield(0,h.gz)(r.Nw.setTotal(t.count)),yield(0,h.gz)(r.Nw.setReconnaissances(t.data)),yield(0,h.gz)(r.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Reconnaissance","Reconnaissance data fetched failed")))}},E=function*(e){try{yield(0,h.gz)(r.Nw.setLoading(!0));let t=yield N.O.create(e.payload),a=yield(0,h.Ys)(T.xK),n=yield N.O.findMany(a);yield(0,h.gz)(r.Nw.setTotal(n.count)),yield(0,h.gz)(r.Nw.setReconnaissances(n.data)),"success"in t&&t.success&&j.emit("create_room",t.taskId),yield(0,h.gz)(r.Nw.setLoading(!1)),u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Reconnaissance","Reconnaissance data created successfully"))}catch(e){u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Reconnaissance","Reconnaissance data created failed"))}},C=function*(e){try{yield(0,h.gz)(r.Nw.setLoading(!0)),yield N.O.remove(e.payload);let t=yield(0,h.Ys)(T.xK),a=yield N.O.findMany(t);yield(0,h.gz)(r.Nw.setTotal(a.count)),yield(0,h.gz)(r.Nw.setReconnaissances(a.data)),yield(0,h.gz)(r.Nw.setLoading(!1)),u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Reconnaissance","Reconnaissance data deleted successfully"))}catch(e){u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Reconnaissance","Reconnaissance data deleted failed"))}},L=function*(e){try{yield(0,h.gz)(r.Nw.setLoading(!0));let t=yield N.O.findUnique(e.payload);t.success&&(yield(0,h.gz)(r.Nw.setSelectedReconnaissanceData(t.data)),yield(0,h.gz)(r.Nw.setFlowControl(t.flowControlOptions)),yield(0,h.gz)(r.Nw.setHistory(t.data.history))),yield(0,h.gz)(r.Nw.setLoading(!1))}catch(e){u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Reconnaissance","Reconnaissance data fetched failed"))}},k=function*(e){try{yield(0,h.gz)(r.Nw.setLoading(!0));let t=yield N.O.reportData(e.payload);if(t.success){for(let e of t.data.result){let a=0,n=0,i=0,o=0;for(let t of e.ports)for(let e of t.vulnerability)switch(e.severity){case"critical":a++;break;case"high":n++;break;case"medium":i++;break;case"low":o++}a>0&&(t.data.scan_result.total_score=.9*(t.data.scan_result.total_score||0)),n>0&&(t.data.scan_result.total_score=.99*(t.data.scan_result.total_score||0)),i>0&&(t.data.scan_result.total_score=.999*(t.data.scan_result.total_score||0)),o>0&&(t.data.scan_result.total_score=.9999*(t.data.scan_result.total_score||0))}t.data.scan_result.critical>0&&((t.data.scan_result.total_score||0)>=40?t.data.scan_result.total_score=39:t.data.scan_result.total_score),t.data.scan_result.high>0&&((t.data.scan_result.total_score||0)>=70?t.data.scan_result.total_score=69:t.data.scan_result.total_score),t.data.scan_result.medium>0&&((t.data.scan_result.total_score||0)>=90?t.data.scan_result.total_score=89:t.data.scan_result.total_score),t.data.scan_result.total_score=parseInt((t.data.scan_result.total_score||0).toFixed(0)),yield(0,h.gz)(r.Nw.setPdf(t.data))}yield(0,h.gz)(r.Nw.setLoading(!1))}catch(e){u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Reconnaissance","Reconnaissance data fetched failed"))}},x=function(){return(0,d.GG)(e=>(j.on("update_status",(t,a)=>{e({type:"SOCKET_UPDATE",room:t,data:a})}),()=>{}))},I=function*(){let e=yield(0,h.RE)(x);for(;;){let{room:t,data:a}=yield(0,h.qn)(e),n=(yield(0,h.Ys)(T.Ks)).map(e=>e.id===t?{...e,status:a.status}:e);yield(0,h.gz)(r.Nw.setReconnaissances(n))}},M=function*(){for(;;)yield(0,h.rM)(I)},$=function*(e){try{yield(0,h.gz)(r.Nw.setLoading(!0));let t=yield(0,h.Ys)(T.w5),a=t.id,n=t.history.concat(e.payload);console.log(t);let i=yield N.O.update({id:a,history:n}),o=yield(0,h.Ys)(T.xK),s=yield N.O.findMany(o);yield(0,h.gz)(r.Nw.setTotal(s.count)),yield(0,h.gz)(r.Nw.setReconnaissances(s.data)),"success"in i&&i.success&&j.emit("create_room",i.taskId),yield(0,h.gz)(r.Nw.setLoading(!1)),u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Reconnaissance","Reconnaissance data created successfully"))}catch(e){u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Reconnaissance","Reconnaissance data created failed"))}},_=function*(){yield(0,h.Fm)(r.Nw.fetchReconnaissance,v),yield(0,h.Fm)(r.Nw.createReconnaissance,E),yield(0,h.Fm)(r.Nw.deleteReconnaissance,C),yield(0,h.Fm)(r.Nw.fetchReconnaissanceByid,L),yield(0,h.Fm)(r.Nw.fetchPdfByid,k),yield(0,h.rM)(M),yield(0,h.Fm)(r.Nw.updateHistory,$)},F={createOrUpdate:async function(e){let t=await fetch("/api/setting/menu",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},remove:async function(e){let t=await fetch("/api/setting/menu/delete/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});return await t.json()},findTreeData:async function(){let e=await fetch("/api/setting/menu/muiTree/?sortField=sort&sortOrder=asc",{headers:{"Content-Type":"application/json"}});return await e.json()},findUnique:async function(e){let t=await fetch("/api/setting/menu/".concat(e),{headers:{"Content-Type":"application/json"}});return await t.json()}},D=function*(e){try{yield(0,h.gz)(y.Nw.setLoading(!0));let e=yield F.findTreeData();yield(0,h.gz)(y.Nw.setMenus(e.data)),yield(0,h.gz)(y.Nw.setLoading(!1))}catch(e){console.error(e),yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Menu","Menu data fetched failed")))}},q=function*(e){try{yield(0,h.gz)(y.Nw.setLoading(!0));let t=yield F.createOrUpdate(e.payload),a=yield F.findTreeData();yield(0,h.gz)(y.Nw.setMenus(a.data)),"success"in t&&t.success&&(yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Menu","Menu data created or updated successfully")))),yield(0,h.gz)(y.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Menu","Menu data created failed")))}},b=function*(e){try{yield(0,h.gz)(y.Nw.setLoading(!0)),yield F.remove(e.payload);let t=yield F.findTreeData();yield(0,h.gz)(y.Nw.setMenus(t.data)),yield(0,h.gz)(y.Nw.setLoading(!1)),yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Menu","Menu data deleted successfully")))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Menu","Menu data deleted failed")))}},B=function*(e){try{yield(0,h.gz)(y.Nw.setLoading(!0));let t=yield F.findUnique(e.payload);t.success&&(yield(0,h.gz)(y.Nw.setSelectedMenuData(t.data))),yield(0,h.gz)(y.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Menu","Menu data fetched failed")))}},A=function*(){yield(0,h.Fm)(y.Nw.fetchMenu,D),yield(0,h.Fm)(y.Nw.createMenu,q),yield(0,h.Fm)(y.Nw.deleteMenu,b),yield(0,h.Fm)(y.Nw.fetchMenuById,B)},J={createOrUpdate:async function(e){let t=await fetch("/api/setting/power",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},remove:async function(e){let t=await fetch("/api/setting/power/delete/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});return await t.json()},findMany:async function(){let e=await fetch("/api/setting/power/?sortField=sort&sortOrder=asc",{headers:{"Content-Type":"application/json"}});return await e.json()},findUnique:async function(e){let t=await fetch("/api/setting/power/".concat(e),{headers:{"Content-Type":"application/json"}});return await t.json()},changeRows:async function(e){let t=await fetch("/api/setting/power/changeSort",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}},Z=function*(e){try{yield(0,h.gz)(f.Nw.setLoading(!0));let e=yield J.findMany();yield(0,h.gz)(f.Nw.setPowers(e.data)),yield(0,h.gz)(f.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power data fetched failed")))}},G=function*(e){try{yield(0,h.gz)(f.Nw.setLoading(!0));let t=yield J.createOrUpdate(e.payload),a=yield J.findMany();yield(0,h.gz)(f.Nw.setPowers(a.data)),t.success?yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"power","power data created or updated successfully"))):yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power data created or updated error"))),yield(0,h.gz)(f.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power data created or updated failed")))}},H=function*(e){try{if(yield(0,h.gz)(f.Nw.setLoading(!0)),(yield J.changeRows(e.payload)).success){let e=yield J.findMany();yield(0,h.gz)(f.Nw.setPowers(e.data)),yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Power","Power row change successfully")))}else yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power row change failed")));yield(0,h.gz)(f.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power row change failed")))}},K=function*(e){try{if(yield(0,h.gz)(f.Nw.setLoading(!0)),(yield J.remove(e.payload)).success){let e=yield J.findMany();yield(0,h.gz)(f.Nw.setPowers(e.data)),yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Power","Power data deleted successfully")))}else yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power data deleted failed")));yield(0,h.gz)(f.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power data deleted failed")))}},Y=function*(e){try{yield(0,h.gz)(f.Nw.setLoading(!0));let t=yield J.findUnique(e.payload);t.success&&(yield(0,h.gz)(f.Nw.setSelectedPowerData(t.data))),yield(0,h.gz)(f.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power data fetched failed")))}},Q=function*(){yield(0,h.Fm)(f.Nw.fetchPower,Z),yield(0,h.Fm)(f.Nw.createOrUpdatePower,G),yield(0,h.Fm)(f.Nw.deletePower,K),yield(0,h.Fm)(f.Nw.fetchPowerById,Y),yield(0,h.Fm)(f.Nw.changeRowPower,H)},W={createOrUpdate:async function(e){let t=await fetch("/api/setting/role",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},findMany:async function(){let e=await fetch("/api/setting/role/?sortField=sort&sortOrder=asc",{headers:{"Content-Type":"application/json"}});return await e.json()},findUnique:async function(e){let t=await fetch("/api/setting/role/".concat(e),{headers:{"Content-Type":"application/json"}});return await t.json()},findPowerTreeData:async function(){let e=await fetch("/api/setting/role/powerTree/?sortField=sort&sortOrder=asc",{headers:{"Content-Type":"application/json"}});return await e.json()},remove:async function(e){let t=await fetch("/api/setting/role/delete/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});return await t.json()},changeRows:async function(e){let t=await fetch("/api/setting/role/changeSort",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}},V=function*(e){try{yield(0,h.gz)(w.Nw.setLoading(!0));let e=yield W.findMany();yield(0,h.gz)(w.Nw.setRoles(e.data)),yield(0,h.gz)(w.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Role","Role data fetched failed")))}},X=function*(e){try{yield(0,h.gz)(w.Nw.setLoading(!0));let e=yield W.findPowerTreeData();yield(0,h.gz)(w.Nw.setPowerTree(e.data)),yield(0,h.gz)(w.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Role","Role Power Tree fetched failed")))}},ee=function*(e){try{yield(0,h.gz)(w.Nw.setLoading(!0));let t=yield W.createOrUpdate(e.payload),a=yield W.findMany();yield(0,h.gz)(w.Nw.setRoles(a.data)),"success"in t&&(t.success?yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Role","Role data created or updated successfully"))):yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Role","Role data created false")))),yield(0,h.gz)(w.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Role","Role data created or updated failed")))}},et=function*(e){try{if(yield(0,h.gz)(w.Nw.setLoading(!0)),(yield W.changeRows(e.payload)).success){let e=yield W.findMany();yield(0,h.gz)(w.Nw.setRoles(e.data)),yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Role","Role row change successfully")))}else yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Role","Role row change failed")));yield(0,h.gz)(w.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Role","Role row change failed")))}},ea=function*(e){try{yield(0,h.gz)(w.Nw.setLoading(!0));let t=yield W.remove(e.payload);if("success"in t){if(t.success){let e=yield W.findMany();yield(0,h.gz)(w.Nw.setRoles(e.data)),yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Role","Role data deleted successfully")))}else yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power data deleted failed")))}yield(0,h.gz)(w.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Power","Power data deleted failed")))}},en=function*(e){try{yield(0,h.gz)(w.Nw.setLoading(!0));let t=yield W.findUnique(e.payload);t.success&&(yield(0,h.gz)(w.Nw.setSelectedRoleData(t.data))),yield(0,h.gz)(w.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Role","Role data fetched failed")))}},ei=function*(){yield(0,h.Fm)(w.Nw.fetchRole,V),yield(0,h.Fm)(w.Nw.createOrUpdateRole,ee),yield(0,h.Fm)(w.Nw.changeRowRole,et),yield(0,h.Fm)(w.Nw.deleteRole,ea),yield(0,h.Fm)(w.Nw.fetchRoleById,en),yield(0,h.Fm)(w.Nw.fetchPowerTree,X)},eo={createOrUpdate:async function(e){let t=await fetch("/api/setting/member",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},findMany:async function(){let e=await fetch("/api/setting/member/?sortField=id&sortOrder=asc",{headers:{"Content-Type":"application/json"}});return await e.json()},findRole:async function(){let e=await fetch("/api/setting/member/role/?sortField=sort&sortOrder=asc",{headers:{"Content-Type":"application/json"}});return await e.json()},findUnique:async function(e){let t=await fetch("/api/setting/member/".concat(e),{headers:{"Content-Type":"application/json"}});return await t.json()},remove:async function(e){let t=await fetch("/api/setting/member/delete/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});return await t.json()}},es=function*(e){try{yield(0,h.gz)(p.Nw.setLoading(!0));let e=yield eo.findMany();yield(0,h.gz)(p.Nw.setUsers(e.data)),yield(0,h.gz)(p.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data fetched failed")))}},ed=function*(){try{yield(0,h.gz)(p.Nw.setLoading(!0));let e=yield eo.findRole();yield(0,h.gz)(p.Nw.setUserRole(e.data)),yield(0,h.gz)(p.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User Role fetched failed")))}},ec=function*(e){try{yield(0,h.gz)(p.Nw.setLoading(!0));let t=yield eo.createOrUpdate(e.payload),a=yield eo.findMany();yield(0,h.gz)(p.Nw.setUsers(a.data)),t.success?yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"User","User data created or updated successfully"))):yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data created false"))),yield(0,h.gz)(p.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data created failed")))}},el=function*(e){try{if(yield(0,h.gz)(p.Nw.setLoading(!0)),(yield eo.remove(e.payload)).success){let e=yield eo.findMany();yield(0,h.gz)(p.Nw.setUsers(e.data)),yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"User","User data deleted successfully")))}else yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data deleted error")));yield(0,h.gz)(p.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data deleted failed")))}},er=function*(e){try{yield(0,h.gz)(p.Nw.setLoading(!0));let t=yield eo.findUnique(e.payload);t.success&&(yield(0,h.gz)(p.Nw.setSelectedUserData(t.data))),yield(0,h.gz)(p.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data fetched failed")))}},ey=function*(){yield(0,h.Fm)(p.Nw.fetchUser,es),yield(0,h.Fm)(p.Nw.fetchUserRole,ed),yield(0,h.Fm)(p.Nw.createUser,ec),yield(0,h.Fm)(p.Nw.deleteUser,el),yield(0,h.Fm)(p.Nw.fetchUserById,er)},eu={changeInfo:async e=>{let t=await fetch("/api/setting/profile/updateInfo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},changePassword:async e=>{let t=await fetch("/api/setting/profile/updatePassword",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return(await t.json()).success&&(0,i.signOut)(),await t.json()},changeExternalIp:async e=>{let t=await fetch("/api/setting/profile/externalIp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},fetchExternalIp:async()=>{let e=await fetch("/api/setting/profile/externalIp",{method:"GET",headers:{"Content-Type":"application/json"}});return await e.json()}},ef=function*(e){try{yield(0,h.gz)(g.Nw.setLoading(!0)),(yield eu.changeInfo(e.payload))&&(yield(0,h.gz)(g.Nw.setUserInfo(e.payload)),yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"User","User Info update success")))),yield(0,h.gz)(g.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data fetched failed")))}},ew=function*(e){try{yield(0,h.gz)(g.Nw.setLoading(!0)),(yield eu.changePassword(e.payload))&&(yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"Chage Password","User password update success")))),yield(0,h.gz)(g.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"Chage Password"," Old Password Failed")))}},ep=function*(e){try{yield(0,h.gz)(g.Nw.setLoading(!0)),(yield eu.changeExternalIp(e.payload))&&(yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.SUCCESS,"User","ExternalIp update success")))),yield(0,h.gz)(g.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data fetched failed")))}},eg=function*(){try{yield(0,h.gz)(g.Nw.setLoading(!0));let e=yield eu.fetchExternalIp();yield(0,h.gz)(g.Nw.setExternalIp(e)),yield(0,h.gz)(g.Nw.setLoading(!1))}catch(e){yield(0,h.gz)(u.Nw.notificationReceived((0,u.uc)(u.k$.ERROR,"User","User data fetched failed")))}},eR=function*(){yield(0,h.Fm)(g.Nw.updateUserInfo,ef),yield(0,h.Fm)(g.Nw.updateUserPassword,ew),yield(0,h.Fm)(g.Nw.updateExternalIp,ep),yield(0,h.Fm)(g.Nw.fetchExternalIp,eg)},eh=(0,d.ZP)(),eN=(0,s.xC)({reducer:R,middleware:e=>e().concat(eh)});function ez(e){let{children:t,session:a}=e;return(0,n.jsx)(i.SessionProvider,{session:a,children:(0,n.jsx)(o.zt,{store:eN,children:t})})}eh.run(U),eh.run(_),eh.run(A),eh.run(Q),eh.run(ei),eh.run(ey),eh.run(eR)},76521:function(e,t,a){"use strict";a.d(t,{LM:function(){return L},k$:function(){return i},Nw:function(){return x},uc:function(){return k},TH:function(){return M},I6:function(){return I}});var n,i,o=a(91116),s=a(31116);let d=()=>new Date().getTime(),c={ids:[],entities:{},lastUpdatedAt:d()},l=(0,s.oM)({name:"notifications",initialState:c,reducers:{notificationRunCompleted:e=>{e.lastUpdatedAt=d()},notificationShownToUser:(e,t)=>{let a=d(),n=t.payload,i=e.entities[n];i&&(e.entities[n]={...i,lastUpdatedAt:a})},notificationReceived:(e,t)=>{let a=t.payload,{id:n}=a;0>e.ids.indexOf(n)&&e.ids.push(n),e.entities[n]={...a,lastUpdatedAt:d()}},updateNotification:(e,t)=>{let{id:a,changes:n}=t.payload,i=e.entities[a];i&&(e.entities[a]={...i,...n,lastUpdatedAt:d()})},deleteNotification:(e,t)=>{e.ids=e.ids.filter(e=>e!==t.payload),delete e.entities[t.payload]}}}),{actions:r,reducer:y}=l;var u=a(74042),f=a(57437),w=a(2265),p=a(33814);a(44193);var g=a(40468),R=a(34990),h=a(80511),N=a(60335),z=a(22419),m=a(47109),O=a(49780),S=a(67791),U=a(7630);let P={success:z.Z,error:S.Z,warning:O.Z,info:m.Z,loading:()=>(0,f.jsx)(g.Z,{size:20})},T=e=>{switch(e){case"success":return"#3bb232";case"error":return"#d23131";case"warning":return"#338633";default:return"inherit"}},j={display:"flex",alignItems:"center",padding:"0.5rem 1rem"},v={width:"2rem",marginRight:"1rem"},E={flex:1},C=e=>{let{primaryText:t,secondaryText:a,closeToast:n,notificationType:i}=e,o=P[i],s=T(i);return(0,f.jsxs)(R.Z,{style:{...j,color:s},children:[(0,f.jsx)("div",{style:v,children:(0,f.jsx)(o,{})}),(0,f.jsxs)("div",{style:E,children:[(0,f.jsx)(h.Z,{variant:"subtitle2",color:"inherit",children:t}),(0,f.jsx)(h.Z,{variant:"caption",color:"inherit",children:a})]}),(0,f.jsx)(N.Z,{onClick:n,children:(0,f.jsx)(U.Z,{})})]})};a(89530);let L=e=>{let{notifications:t,onShow:a,onClose:n,onNotificationRunCompleted:o}=e;return(0,w.useEffect)(()=>{t.length>0&&(t.forEach(e=>{let t=p.Am.isActive(e.id),o={toastId:e.id,autoClose:e.notificationType!==i.LONG_RUNNING&&5e3,onClose:()=>n(e),onOpen:()=>a(e)},s=(0,f.jsx)(C,{notificationType:e.notificationType,primaryText:e.primaryText,secondaryText:e.secondaryText,closeToast:()=>{setTimeout(()=>n(e),550)}});t?p.Am.update(e.id,{render:s,...o}):(0,p.Am)(s,o)}),o())},[t,n,o,a]),(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(p.Ix,{closeButton:!1,hideProgressBar:!0})})};(n=i||(i={})).ERROR="error",n.SUCCESS="success",n.WARNING="warning",n.INFO="info",n.LONG_RUNNING="loading";let k=(e,t,a,n)=>({id:n||(0,o.x0)(),lastUpdatedAt:new Date().getTime(),notificationType:e,primaryText:t,secondaryText:a}),{actions:x}=l,{reducer:I}=l,M=(0,u.P1)([e=>e.notification],e=>{let{lastUpdatedAt:t,ids:a,entities:n}=e;return a.reduce((e,a)=>{let i=n[a];return i&&i.lastUpdatedAt>t&&e.push(i),e},[])})},34436:function(e,t,a){"use strict";a.d(t,{I6:function(){return i},Nw:function(){return n}});let{actions:n,reducer:i}=(0,a(31116).oM)({name:"sidebar",initialState:{loading:!1,userInfo:{},userPassword:{},externalIp:{}},reducers:{setLoading(e,t){e.loading=t.payload},setUserInfo(e,t){e.userInfo=t.payload},updateUserInfo(e,t){},updateUserPassword(e,t){},updateExternalIp(e,t){},fetchExternalIp(e){},setExternalIp(e,t){e.externalIp=t.payload}}})},751:function(e,t,a){"use strict";a.r(t),a.d(t,{ThemeRegistry:function(){return f}});var n=a(57437),i=a(2265),o=a(74050),s=a(81705),d=a(20124),c=a(46309),l=a(16463),r=a(22606);function y(e){let{options:t,CacheProvider:a=r.C,children:o}=e,[s]=i.useState(()=>{let e=(0,c.Z)(t);e.compat=!0;let a=e.insert,n=[];return e.insert=function(){for(var t=arguments.length,i=Array(t),o=0;o<t;o++)i[o]=arguments[o];let[s,d]=i;return void 0===e.inserted[d.name]&&n.push({name:d.name,isGlobal:!s}),a(...i)},{cache:e,flush:()=>{let e=n;return n=[],e}}});return(0,l.useServerInsertedHTML)(()=>{let e=s.flush();if(0===e.length)return null;let t="",a=s.cache.key,o=[];return e.forEach(e=>{let{name:n,isGlobal:i}=e,d=s.cache.inserted[n];"boolean"!=typeof d&&(i?o.push({name:n,style:d}):(t+=d,a+=" ".concat(n)))}),(0,n.jsxs)(i.Fragment,{children:[o.map(e=>{let{name:t,style:a}=e;return(0,n.jsx)("style",{"data-emotion":"".concat(s.cache.key,"-global ").concat(t),dangerouslySetInnerHTML:{__html:a}},t)}),t&&(0,n.jsx)("style",{"data-emotion":a,dangerouslySetInnerHTML:{__html:t}})]})}),(0,n.jsx)(a,{value:s.cache,children:o})}let u=(0,o.Z)({palette:{mode:"dark",primary:{main:"#fff"},secondary:{main:"#f50057"},text:{primary:"#fff",secondary:"#a9a9a9"}}});function f(e){let{children:t}=e;return(0,n.jsx)(y,{options:{key:"mui"},children:(0,n.jsxs)(s.Z,{theme:u,children:[(0,n.jsx)(d.ZP,{}),t]})})}},55972:function(e,t,a){"use strict";a.d(t,{mN:function(){return s},mP:function(){return o}});var n=a(21316);let i=null,o=()=>(!i&&(i=(0,n.io)("http://phalanx.console:8000",{transports:["websocket"]})),i),s=()=>{i&&(i.disconnect(),i=null)}},2852:function(e,t,a){"use strict";a.d(t,{O:function(){return n}});let n={create:async e=>{let t=await fetch("/api/task/reconnaissance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},update:async e=>{let t=await fetch("/api/task/reconnaissance",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},findMany:async e=>{let t=[];if(e){if(e.status&&t.push("status=".concat(e.status)),null!=e.page&&t.push("page=".concat(e.page+1)),e.pageSize&&t.push("pageSize=".concat(e.pageSize)),e.sortModel){let a=JSON.stringify(e.sortModel);t.push("sortModel=".concat(encodeURIComponent(a)))}if(e.queryOptions){let a=JSON.stringify(e.queryOptions);t.push("queryOptions=".concat(encodeURIComponent(a)))}}let a="/api/task/reconnaissance/?".concat(t.join("&")),n=await fetch(a,{headers:{"Content-Type":"application/json"}});return await n.json()},findUnique:async e=>{let t=await fetch("/api/task/reconnaissance/".concat(e),{headers:{"Content-Type":"application/json"}});return await t.json()},control:async e=>{let t=await fetch("/api/task/reconnaissance/control",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},remove:async e=>{let t=await fetch("/api/task/reconnaissance/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});return await t.json()},reportData:async e=>{let t=await fetch("/api/task/reconnaissance/pdf/".concat(e),{headers:{"Content-Type":"application/json"}});return await t.json()},reportExploitData:async e=>{let t=await fetch("/api/task/exploit/pdf/".concat(e),{headers:{"Content-Type":"application/json"}});return await t.json()}}},89530:function(){}}]);